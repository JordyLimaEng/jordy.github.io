<!DOCTYPE HTML>
<html lang="pt-BR">
<link rel="icon" href="https://sites.google.com/a/ci.ufpb.br/lmi/_/rsrc/1459564538865/config/customLogo.gif?revision=8" type="image/x-icon"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
<title>LMI - PROTOCOLO DE COMUNICACAO</title>

<head>

<script language="javascript">

/*$(document).ready(function(){
  console.log("data");
    $.getJSON( "150.165.202.10", function(data) {
         console.log(data);

    });
});*/

$.ajax({ url: 'http://150.165.202.10', headers: {'X-Requested-With': 'XMLHttpRequest'} /*,crossDomain: false*/, dataType:'text', success: function(data)  { 
  //alert(data);
  console.log(data)

 var str = data;

var str_ = str.substr(51,8);
var str__= "Time Out";

if( str_ == str__){
	alert('TIME OUT');
}else{

 var D1_r = str.substr(59,2);
 var D1_r_ = parseInt(D1_r, 16);
 id( 'D1_r' ).value = D1_r_;
 
 var D2_r = str.substr(61,2);
 var D2_r_ = parseInt(D2_r, 16);
 id( 'D2_r' ).value = D2_r_;
 
 var D3_r = str.substr(63,2);
 var D3_r_ = parseInt(D3_r, 16);
 id( 'D3_r' ).value = D3_r_;
 
 var D4_r = str.substr(65,2);
 var D4_r_ = parseInt(D4_r, 16);
 id( 'D4_r' ).value = D4_r_;
 
 var D5_r = str.substr(67,2);
 var D5_r_ = parseInt(D5_r, 16);
 id( 'D5_r' ).value = D5_r_;
 
 var D6_r = str.substr(69,2);
 var D6_r_ = parseInt(D6_r, 16);
 id( 'D6_r' ).value = D6_r_;
 
 var PAD_r = str.substr(71,2);
 var PAD_r_ = parseInt(PAD_r, 16);
 id( 'PAD_r' ).value = PAD_r_;
 
 var CRC_r = str.substr(73,2);
 var CRC_r_ = parseInt(CRC_r, 16);
 id( 'CRC_r' ).value = CRC_r_;
}

 } });

//var markup = document.documentElement.outerHTML;
//alert(markup);

function id( el ){
  return document.getElementById( el );
}

  /*
  var A = '{"enviado": "01fe0005ffffffffffff34", "resposta": "Time Out"}';
  var Aj = JSON.parse(A);
  alert(Aj["enviado"]);
  alert(Aj["resposta"]);*/

 function ChamarLink() {
    var valorCombo = document.getElementById("selectOK").value;
    //document.getElementById("receberLink").innerHTML = "qual="+valorCombo+"'>agora sim</a>";

    if (document.getElementById("selectOK").value == "01") {
      document.getElementById("COD").value = "79";
    } else if (document.getElementById("selectOK").value == "02"){
      document.getElementById("COD").value = "77";
    
    }else if (document.getElementById("selectOK").value  == "03"){
      document.getElementById("COD").value = "84";
    
    } else if (document.getElementById("selectOK").value == "04"){
      document.getElementById("COD").value = "86";
    
    } else if (document.getElementById("selectOK").value == "05"){
      document.getElementById("COD").value = "6";
    
    } else if (document.getElementById("selectOK").value == "06"){
      document.getElementById("COD").value = "21";
    
    } else if (document.getElementById("selectOK").value == "07"){
      document.getElementById("COD").value = "82";
    
    } else if (document.getElementById("selectOK").value == "08"){
      document.getElementById("COD").value = "83";
    
    } else if (document.getElementById("selectOK").value == "09"){
      document.getElementById("COD").value = "81";
    
    } else if (document.getElementById("selectOK").value == "10"){
      document.getElementById("COD").value = "5";
    
    } else if (document.getElementById("selectOK").value == "11"){
      document.getElementById("COD").value = "51";
    
    } else if (document.getElementById("selectOK").value == "12"){
      document.getElementById("COD").value = "52";
      
    } else if (document.getElementById("selectOK").value == "13"){
      document.getElementById("COD").value = "53";
    
    } else if (document.getElementById("selectOK").value == "14"){
      document.getElementById("COD").value = "54";
    
    } else if (document.getElementById("selectOK").value == "15"){
      document.getElementById("COD").value = "55";
    
    } else if (document.getElementById("selectOK").value == "16"){
      document.getElementById("COD").value = "56";
    }else{      document.getElementById("COD").value = "---";}
    
    }

function myFunction(){
 
    var1  = id('IDS').value;
    var2  = id('IDD').value;
    var17 = id('COD').value;
    var3  = id( 'D1').value;
    var4  = id( 'D2').value;
    var5  = id( 'D3').value;
    var6  = id( 'D4').value;
    var7  = id( 'D5').value;
    var8  = id( 'D6').value;
    var9  = id('PAD').value;
    //var10 = id('SOH').value; //Não se faz necessário, já que é o "01" padrão de início do pacote
    var11 = id('CRC').value; //Soma de todos os campos % 256 ... 
  
  var var1_ = parseInt(var1);
  var var1_h = var1_.toString(16);
  if (var1_h.length == 1) var1_h = "0" + var1_h;

  var var2_ = parseInt(var2);
  var var2_h = var2_.toString(16);
  if (var2_h.length == 1) var2_h = "0" + var2_h;

  var var17_ = parseInt(var17);
  var var17_h = var17_.toString(16);
  if (var17_h.length == 1) var17_h = "0" + var17_h;

  var var3_ = parseInt(var3);
  var var3_h = var3_.toString(16);
  if (var3_h.length == 1) var3_h = "0" + var3_h;

  var var4_ = parseInt(var4);
  var var4_h = var4_.toString(16);
  if (var4_h.length == 1) var4_h = "0" + var4_h;

  var var5_ = parseInt(var5);
  var var5_h = var5_.toString(16);
  if (var5_h.length == 1) var5_h = "0" + var5_h;

  var var6_ = parseInt(var6);
  var var6_h = var6_.toString(16);
  if (var6_h.length == 1) var6_h = "0" + var6_h;

  var var7_ = parseInt(var7);
  var var7_h = var7_.toString(16);
  if (var7_h.length == 1) var7_h = "0" + var7_h;

  var var8_ = parseInt(var8);
  var var8_h = var8_.toString(16);
  if (var8_h.length == 1) var8_h = "0" + var8_h;

  var var9_ = parseInt(var9);
  var var9_h = var9_.toString(16);
  if (var9_h.length == 1) var9_h = "0" + var9_h;
  
  var soma_campos = var1_+var2_+var17_+var3_+var4_+var5_+var6_+var7_+var8_;
  var var11_ = soma_campos % 256;
  var var11_h = var11_.toString(16);
  //if (var11_h.length == 1) var11_h = "0" + var11_h;
  id('CRC').value = var11_;
  
  var13 = id('Ip1').value;
  var14 = id('Ip2').value;
  var15 = id('Ip3').value;
  var16 = id('Ip4').value;

  var500 = var13+"."+var14+"."+var15+"."+var16+"/"+"01"+var1_h+var2_h+var17_h+var3_h+var4_h+var5_h+var6_h+var7_h+var8_h+var9_h+var11_h;
  var600 = "http://" + var500;  
  //window.location=var600;
  //var n_window = window.open("Index.html", '_blank');
  //var new_window = window.open(var600, '_blank');
  
  //id('page').value = var600;
  
  //ip Esp = http://150.165.202.10

   ifrm = document.createElement("IFRAME");
   ifrm.setAttribute("src", var600);
   ifrm.style.width = 800+"px";
   ifrm.style.height = 150+"px";
   document.body.appendChild(ifrm);
  
  // ifrm.parentNode.removeChild(ifrm);
}
function myEraseIfrm(){
  ifrm.parentNode.removeChild(ifrm);
}

</script>

</head>
<a href="http://lmi.ci.ufpb.br/" target="_blank" >
<img src="https://sites.google.com/a/ci.ufpb.br/lmi/_/rsrc/1459564538865/config/customLogo.gif?revision=8" alt="Lmi-link" width="170" height="88">
</a>
&ensp;
<div class="dropdown">
  <span>About</span>
  <div class="dropdown-content">
    <p>Development by</p>
	<p style="text-decoration:underline;"> Jordy Allyson</p>
	<p>Graduate student of Computer Engineering</p>
	<p>Contact: jordy.sousa@eng.ci.ufpb.br</p>
  </div>
</div>
<body bgcolor = "#FFEFD5">
<p align = "left"><font color="#00008B"><br><b>Dados Enviados</b></br></font>

<td>
<style>

.dropdown {
    position: relative;
    display: inline-block;
	color: black;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    padding: 12px 16px;
    z-index: 1;
}

.dropdown:hover .dropdown-content {
    display: block;
}

.button{
     position: relative;
    background-color: #FF0000;
    border: none;
    font-size: 12.8px;
    color: #FFFFFF;
    padding: 3.5px;
    width: 75px;
    text-align: center;
    -webkit-transition-duration: 0.4s; /* Safari */
    transition-duration: 0.4s;
    text-decoration: none;
    overflow: hidden;
    cursor: pointer;
}
.button:after {
    content: "";
    background: #f1f1f1;
    display: block;
    position: absolute;
    padding-top: 300%;
    padding-left: 350%;
    margin-left: -20px !important;
    margin-top: -120%;
    opacity: 0;
    transition: all 0.8s
}

.button:active:after {
    padding: 0;
    margin: 0;
    opacity: 1;
    transition: 0s
}

</style>

<b><br><font color="#228B22">Origem &ensp;&ensp; &ensp; Destino</font> &ensp; &emsp;&emsp;&emsp;&emsp; &ensp; <font color="#B8860B">Instrucao Cod</font></br></b>&ensp;
<input type="text" name="IDS" id="IDS" size="2" placeholder="0-255" maxlength="3" min=0 max=255>
&ensp;&ensp;&ensp; &nbsp;&nbsp; 
<input type="text" name="IDD" id="IDD" size="2" placeholder="0-255" maxlength="3" min=0 max=255>
&emsp; &ensp; &emsp;
<input type="text" name="COD" id="COD" size="2" placeholder="0-255" maxlength="3" min=0 max=255>
&emsp;

<select id="selectOK" name="selectOK" onchange="ChamarLink();">
    <option value="  ">Selecione</option>
    <option value="01">Liga/Desl Dispositivo</option>
    <option value="02">Altera Nível de Potência</option>
    <option value="03">Solicita Medida do Sensor</option>
    <option value="04">Resposta do Sensor</option>
    <option value="05">ACK</option>
    <option value="06">NACK</option>
    <option value="07">RESET</option>
    <option value="08">Solicita Setpoint</option>
    <option value="09">Altera Setpoint</option>
    <option value="10">Está Operacional?</option>
    <option value="11">Escreve 1 BYTE</option>
    <option value="12">Escreve 1 WORD</option>
    <option value="13">Escreve 2 WORD</option>
    <option value="14">Escreve N BYTES</option>
    <option value="15">Solicita N BYTES</option>
    <option value="16">Responde N BYTES</option>
</select>

<p id="BA"></p>

<font color="#00008B"><br><b>&emsp; &emsp; &emsp; &emsp; Dados</b></br></font>
<td>

<br align = "left"><font color="#00008B">&ensp;&ensp;D1 &ensp;&ensp;&ensp; D2 &ensp;&ensp;&ensp; D3 &ensp;&ensp;&ensp; D4 &ensp;&ensp;&ensp; D5 &ensp;&ensp; 
            D6</font> &ensp;&ensp; <font color="#B8860B">PAD</font> &ensp;&ensp; <font color="#FF000">CRC </font></br>

<input type="text" name="D1"  id="D1"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D2"  id="D2"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D3"  id="D3"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D4"  id="D4"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D5"  id="D5"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D6"  id="D6"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="PAD" id="PAD"  size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="CRC" id="CRC"  size="2" placeholder="0-255" maxlength="3"  min=0 max=255>
</td>

<td>
<p>
<input type="text" name="D1_r"  id="D1_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D2_r"  id="D2_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D3_r"  id="D3_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D4_r"  id="D4_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D5_r"  id="D5_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="D6_r"  id="D6_r"   size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="PAD_r" id="PAD_r"  size="2" placeholder="0-255"   maxlength="3"  min=0 max=255>
<input type="text" name="CRC_r" id="CRC_r"  size="2" placeholder="0-255" maxlength="3"  min=0 max=255>
</p>
</td>

<td>

<br align = "left"><font color="red">IP:</font></br>
<input type="text" name="Ip1" id="Ip1"  value="150" size="1" placeholder="0-255" maxlength="3">
<input type="text" name="Ip2" id="Ip2"  value="165" size="1" placeholder="0-255" maxlength="3">
<input type="text" name="Ip3" id="Ip3"  value="202" size="1" placeholder="0-255" maxlength="3">
<input type="text" name="Ip4" id="Ip4"  value="10"  size="1" placeholder="0-255" maxlength="3">

</td>



<button class="button" onclick="myFunction()" id="bt_enviar">ENVIAR</button>
<button class="button" onclick="myEraseIfrm()" id="bt_ok"   >    CLEAR</button>
<p></p>


</body>

</html>